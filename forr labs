&НаКлиенте
Процедура СотрудникПриИзменении(Элемент)
    
    // Если сотрудник выбран
    Если ЭтотОбъект.Сотрудник <> Неопределено Тогда
        // Автоматически подставляем оклад
        ЭтотОбъект.Начислено = ЭтотОбъект.Сотрудник.Оклад;
    Иначе
        ЭтотОбъект.Начислено = 0;
        ЭтотОбъект.Налог = 0;
    КонецЕсли;
    
    // Рассчитываем налог
    НачисленоПриИзменении(Элемент);
    
КонецПроцедуры

&НаКлиенте
Процедура НачисленоПриИзменении(Элемент)
    
    // Проверяем сотрудника
    Если ЭтотОбъект.Сотрудник = Неопределено Тогда
        ЭтотОбъект.Налог = 0;
        Возврат;
    КонецЕсли;
    
    // Проверяем сумму
    Если ЭтотОбъект.Начислено <= 0 Тогда
        ЭтотОбъект.Налог = 0;
        Возврат;
    КонецЕсли;
    
    // Проверяем ставку
    Если ЭтотОбъект.Сотрудник.НалоговаяСтавка = 0 Тогда
        ЭтотОбъект.Налог = 0;
        Возврат;
    КонецЕсли;
    
    // Рассчитываем налог
    Ставка = ЭтотОбъект.Сотрудник.НалоговаяСтавка;
    ЭтотОбъект.Налог = Окр(ЭтотОбъект.Начислено * Ставка / 100, 2);
    
КонецПроцедуры